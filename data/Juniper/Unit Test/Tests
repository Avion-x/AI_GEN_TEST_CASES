 ###STARTLIST###
[
  {
    "testname": "OSPF Neighborship Test",
    "testcase": {
      "testname": "OSPF Neighborship Test",
      "objective": "Verify OSPF neighborship is established between MX devices",
      "steps": [
        "Configure OSPF on MX devices", 
        "Verify OSPF neighborship is up between MX devices"
      ],
      "test_data": {
        "mx_devices": [
          "mx480-1",
          "mx480-2"
        ],
        "ospf_process_id": "100",
        "ospf_area": "0"
      }
    },
    "testscript": {
      "testname": "OSPF Neighborship Test",
      "objective": "Verify OSPF neighborship is established between MX devices", 
      "file_name": "ospf_neighborship_test.py",
      "init_scripts": "pip install jnpr.junos pyez",
      "script": """
        import jnpr.junos as pyez
        
        def test_ospf_neighborship(mx_devices, ospf_process_id, ospf_area):
          for device in mx_devices:
            conn = pyez.Device(host=device, user='test', password='Pass123')
            conn.open()
            ospf_neighbors = conn.rpc.get_ospf_neighbor_information(ospf_area = ospf_area)
            assert len(ospf_neighbors) > 0
            conn.close
          
        if __name__ == '__main__':
          mx_devices = %test_data['mx_devices']%  
          ospf_process_id = %test_data['ospf_process_id']%
          ospf_area = %test_data['ospf_area']%
          
          test_ospf_neighborship(mx_devices, ospf_process_id, ospf_area)
        """,
      "run_command": "python ospf_neighborship_test.py",
      "expected_result": "OSPF neighborship established between MX devices"
    }
  },
  {
    "testname": "BGP Session Test", 
    "testcase": {
      "testname": "BGP Session Test",
      "objective": "Verify BGP session is established between MX devices",
      "steps": [
        "Configure BGP on MX devices",
        "Verify BGP session is up between MX devices"  
      ],
      "test_data": {
        "mx_devices": [
          "mx480-1", 
          "mx480-2"
        ],
        "bgp_as": "65100"  
      }
    },
    "testscript": {
      "testname": "BGP Session Test",
      "objective": "Verify BGP session is established between MX devices",
      "file_name": "bgp_session_test.py", 
      "init_scripts": "pip install jnpr.junos pyez", 
      "script": """
        import jnpr.junos as pyez
        
        def test_bgp_session(mx_devices, bgp_as):
          for device in mx_devices:
            conn = pyez.Device(host=device, user='test', password='Pass123')
            conn.open()
            bgp_summary = conn.rpc.get_bgp_summary_information()
            assert bgp_summary['bgp-peer-count'] > 0
            conn.close
        
        if __name__ == '__main__':
          mx_devices = %test_data['mx_devices']%
          bgp_as = %test_data['bgp_as']%
          
          test_bgp_session(mx_devices, bgp_as)
        """,
      "run_command": "python bgp_session_test.py",
      "expected_result": "BGP session established between MX devices"
    }
  }
]
###ENDLIST###