 ###STARTLIST###
[
  {
    "testname": "VLAN creation", 
    "testcase": {
      "testname": "VLAN creation",
      "objective": "Verify VLANs can be created on the MX480",
      "steps": [
        "Configure VLAN 100 on interface ge-0/0/0", 
        "Verify VLAN 100 is configured and up"
      ],
      "data": {
        "vlan_id": 100, 
        "interface": "ge-0/0/0" 
      }
    },
    "testscript": {
      "testname": "VLAN creation",
      "objective": "Automate VLAN creation test case",
      "file_name": "test_vlan_creation.py",
      "init_scripts": [
        "pip install netmiko",
        "pip install junos-eznc"
      ],
      "script": """
import netmiko
from junos_eznc import Device

vlan_id = 100
interface = "ge-0/0/0"

with Device() as dev:
  dev.cli('configure')
  dev.cli(f'set vlans {vlan_id} vlan-id {vlan_id}')
  dev.cli(f'set interfaces {interface} unit 0 family ethernet-switching vlan members {vlan_id}')
  dev.cli('commit')
  
  output = dev.cli('show vlans')
  assert f'vlan-{vlan_id}' in output
""",
"run_command": "python test_vlan_creation.py",
"expected_result": "VLAN 100 configured on ge-0/0/0"
    }
  },

  {
    "testname": "VLAN deletion",
    "testcase": {
      "testname": "VLAN deletion",
      "objective": "Verify VLANs can be deleted on the MX480",
      "steps": [
        "Configure VLAN 200 on interface ge-0/0/1",
        "Delete VLAN 200",
        "Verify VLAN 200 is removed"  
      ],
      "data": {
        "vlan_id": 200,
        "interface": "ge-0/0/1"
      }
    },
    "testscript": {
      "testname": "VLAN deletion",
      "objective": "Automate VLAN deletion test case", 
      "file_name": "test_vlan_deletion.py",
      "init_scripts": [
        "pip install netmiko",
        "pip install junos-eznc"  
      ],
      "script": """
import netmiko
from junos_eznc import Device

vlan_id = 200
interface = "ge-0/0/1"

with Device() as dev:
  dev.cli('configure')
  dev.cli(f'set vlans {vlan_id} vlan-id {vlan_id}') 
  dev.cli(f'set interfaces {interface} unit 0 family ethernet-switching vlan members {vlan_id}')
  dev.cli('commit')
  
  dev.cli('configure')
  dev.cli(f'delete vlans {vlan_id}')
  dev.cli('commit')

  output = dev.cli('show vlans')
  assert f'vlan-{vlan_id}' not in output
""",
"run_command": "python test_vlan_deletion.py", 
"expected_result": "VLAN 200 removed from ge-0/0/1"
    }
  }
]
###ENDLIST###