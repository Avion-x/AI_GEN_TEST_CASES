 ###STARTLIST###
[
  {
    "testname": "VPN Bandwidth Management Test", 
    "testcase": {
      "testname": "VPN Bandwidth Management Test",
      "objective": "Validate VPN bandwidth management configuration on MX240",
      "steps": [
        "1. Configure VPN bandwidth management policy",
        "2. Apply policy to VPN interface",        
        "3. Validate bandwidth usage does not exceed configured limit"
      ],
      "testdata": {
        "bandwidth_limit": "10mbps",
        "vpn_interface": "ge-0/0/1"
      }
    },
    "testscript": {
      "testname": "VPN Bandwidth Management Test",
      "objective": "Validate VPN bandwidth management configuration on MX240",
      "file_name": "vpn_bandwidth_test.py",
      "init_scripts":[
        "pip install paramiko",
        "pip install junos-eznc"
      ],
      "script": """
import json
import paramiko
from jnpr.junos import Device

# Test data
test_data = json.loads('''{test_data}''')
bandwidth_limit = test_data['bandwidth_limit']
vpn_interface = test_data['vpn_interface']

# Connect to device
dev = Device(host='192.168.0.1', user='pyuser', password='pypass')
dev.open()

# Get current bandwidth usage
intf_bandwidth = dev.cli('show interfaces {vpn_interface} extensive'.format(vpn_interface=vpn_interface))
curr_bandwidth = extract_bandwidth_usage(intf_bandwidth) 

# Validate bandwidth does not exceed configured limit
assert curr_bandwidth <= bandwidth_limit, "Bandwidth limit exceeded"

# Close connection
dev.close()

def extract_bandwidth_usage(intf_output):
    # Parse CLI output to extract current bandwidth usage
    # .....
    return bandwidth_usage 
""",
      "run_command": "python vpn_bandwidth_test.py",
      "expected_result": "Bandwidth usage validated to be under configured limit"  
    }
  }
]
###ENDLIST###